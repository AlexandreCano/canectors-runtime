{
  "connector": {
    "name": "complete-pipeline-example",
    "version": "1.0.0",
    "description": "Complete example with authentication, pagination, filters, retry, and advanced configurations",
    "defaults": {
      "onError": "fail",
      "timeoutMs": 30000,
      "retry": {
        "maxAttempts": 3,
        "delayMs": 1000,
        "backoffMultiplier": 2
      }
    },
    "input": {
      "type": "httpPolling",
      "endpoint": "https://api.source.com/orders",
      "schedule": "0 */6 * * *",
      "timeoutMs": 60000,
      "headers": {
        "Accept": "application/json",
        "User-Agent": "Cannectors-Runtime/1.0"
      },
      "dataField": "orders",
      "pagination": {
        "type": "page",
        "pageParam": "page",
        "totalPagesField": "meta.total_pages"
      },
      "authentication": {
        "type": "oauth2",
        "credentials": {
          "tokenUrl": "https://auth.source.com/oauth/token",
          "clientId": "${SOURCE_CLIENT_ID}",
          "clientSecret": "${SOURCE_CLIENT_SECRET}",
          "scope": "orders:read"
        }
      }
    },
    "filters": [
      {
        "type": "condition",
        "expression": "status == 'completed' && total > 0",
        "lang": "simple",
        "onTrue": "continue",
        "onFalse": "skip",
        "onError": "log"
      },
      {
        "type": "mapping",
        "mappings": [
          {
            "source": "id",
            "target": "orderId",
            "onMissing": "fail"
          },
          {
            "source": "customer.id",
            "target": "customerId"
          },
          {
            "source": "customer.name",
            "target": "customerName",
            "defaultValue": "Anonymous",
            "onMissing": "useDefault"
          },
          {
            "source": "total",
            "target": "amount",
            "transforms": [
              {
                "op": "toFloat"
              }
            ]
          },
          {
            "source": "created_at",
            "target": "orderDate",
            "transforms": [
              {
                "op": "dateFormat",
                "format": "2006-01-02T15:04:05Z07:00"
              }
            ]
          }
        ],
        "onError": "skip"
      }
    ],
    "output": {
      "type": "httpRequest",
      "endpoint": "https://api.destination.com/v1/orders/{orderId}",
      "method": "PUT",
      "timeoutMs": 45000,
      "headers": {
        "Content-Type": "application/json",
        "X-Source": "cannectors"
      },
      "request": {
        "bodyFrom": "record",
        "pathParams": {
          "orderId": "orderId"
        },
        "query": {
          "sync": "true"
        },
        "queryFromRecord": {
          "version": "orderId"
        },
        "headersFromRecord": {
          "X-Customer-ID": "customerId"
        }
      },
      "retry": {
        "maxAttempts": 3,
        "delayMs": 1000,
        "backoffMultiplier": 2
      },
      "onError": "skip",
      "authentication": {
        "type": "bearer",
        "credentials": {
          "token": "${DEST_API_TOKEN}"
        }
      }
    }
  }
}
